//go:build !noasm && arm64
// Code generated by hwygen -c. DO NOT EDIT.

package loss

import (
	"unsafe"

	"github.com/ajroetker/go-highway/hwy"
	"github.com/ajroetker/go-highway/hwy/contrib/loss/asm"
)

func init() {
	if hwy.HasSME() {
		return
	}
	CutCrossEntropyGrad = cutCrossEntropyGradAsmF32
}

func cutCrossEntropyGradAsmF32(hiddenStates, embeddings []float32, labels []int32, gradOutput []float32, numPositions, hiddenDim, vocabSize int) {
	if len(hiddenStates) == 0 || len(embeddings) == 0 || len(labels) == 0 || len(gradOutput) == 0 {
		return
	}
	numPositionsVal := int64(numPositions)
	hiddenDimVal := int64(hiddenDim)
	vocabSizeVal := int64(vocabSize)
	asm.CutCrossEntropyGrad_F32(
		unsafe.Pointer(&hiddenStates[0]),
		unsafe.Pointer(&embeddings[0]),
		unsafe.Pointer(&labels[0]),
		unsafe.Pointer(&gradOutput[0]),
		unsafe.Pointer(&numPositionsVal),
		unsafe.Pointer(&hiddenDimVal),
		unsafe.Pointer(&vocabSizeVal),
	)
}

