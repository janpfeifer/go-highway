// Code generated by github.com/ajroetker/go-highway/cmd/hwygen. DO NOT EDIT.

//go:build arm64

package sort

import (
	"github.com/ajroetker/go-highway/hwy"
)

var RadixPassInt32 func(src []int32, dst []int32, shift int)
var RadixPassInt64 func(src []int64, dst []int64, shift int)
var RadixPass16Int32 func(src []int32, dst []int32, shift int)
var RadixPass16Int64 func(src []int64, dst []int64, shift int)
var RadixPass16SignedInt32 func(src []int32, dst []int32, shift int)
var RadixPass16SignedInt64 func(src []int64, dst []int64, shift int)
var RadixPassSignedInt32 func(src []int32, dst []int32, shift int)
var RadixPassSignedInt64 func(src []int64, dst []int64, shift int)

// RadixPass performs one pass of LSD radix sort.
// shift specifies which byte to use for bucketing (0, 8, 16, 24 for int32).
// This is the core SIMD-accelerated function for histogram counting.
//
// This function dispatches to the appropriate SIMD implementation at runtime.
func RadixPass[T hwy.SignedInts](src []T, dst []T, shift int) {
	switch any(src).(type) {
	case []int32:
		RadixPassInt32(any(src).([]int32), any(dst).([]int32), shift)
	case []int64:
		RadixPassInt64(any(src).([]int64), any(dst).([]int64), shift)
	}
}

// RadixPass16 performs one pass of 16-bit radix sort.
// shift specifies which 16-bit chunk to use (0, 16, 32, 48 for int64).
// Uses 65536 buckets for faster sorting of int64 (4 passes vs 8 with 8-bit radix).
//
// This function dispatches to the appropriate SIMD implementation at runtime.
func RadixPass16[T hwy.SignedInts](src []T, dst []T, shift int) {
	switch any(src).(type) {
	case []int32:
		RadixPass16Int32(any(src).([]int32), any(dst).([]int32), shift)
	case []int64:
		RadixPass16Int64(any(src).([]int64), any(dst).([]int64), shift)
	}
}

// RadixPass16Signed performs the final 16-bit pass for signed int64.
// The MSB chunk contains the sign bit, so negative numbers (32768-65535) come before positive (0-32767).
//
// This function dispatches to the appropriate SIMD implementation at runtime.
func RadixPass16Signed[T hwy.SignedInts](src []T, dst []T, shift int) {
	switch any(src).(type) {
	case []int32:
		RadixPass16SignedInt32(any(src).([]int32), any(dst).([]int32), shift)
	case []int64:
		RadixPass16SignedInt64(any(src).([]int64), any(dst).([]int64), shift)
	}
}

// RadixPassSigned performs the final pass for signed integers.
// The MSB byte contains the sign bit, so negative numbers (128-255) come before positive (0-127).
//
// This function dispatches to the appropriate SIMD implementation at runtime.
func RadixPassSigned[T hwy.SignedInts](src []T, dst []T, shift int) {
	switch any(src).(type) {
	case []int32:
		RadixPassSignedInt32(any(src).([]int32), any(dst).([]int32), shift)
	case []int64:
		RadixPassSignedInt64(any(src).([]int64), any(dst).([]int64), shift)
	}
}

func init() {
	if hwy.NoSimdEnv() {
		initRadixFallback()
		return
	}
	initRadixNEON()
	return
}

func initRadixNEON() {
	RadixPassInt32 = BaseRadixPass_neon_Int32
	RadixPassInt64 = BaseRadixPass_neon_Int64
	RadixPass16Int32 = BaseRadixPass16_neon_Int32
	RadixPass16Int64 = BaseRadixPass16_neon_Int64
	RadixPass16SignedInt32 = BaseRadixPass16Signed_neon_Int32
	RadixPass16SignedInt64 = BaseRadixPass16Signed_neon_Int64
	RadixPassSignedInt32 = BaseRadixPassSigned_neon_Int32
	RadixPassSignedInt64 = BaseRadixPassSigned_neon_Int64
}

func initRadixFallback() {
	RadixPassInt32 = BaseRadixPass_fallback_Int32
	RadixPassInt64 = BaseRadixPass_fallback_Int64
	RadixPass16Int32 = BaseRadixPass16_fallback_Int32
	RadixPass16Int64 = BaseRadixPass16_fallback_Int64
	RadixPass16SignedInt32 = BaseRadixPass16Signed_fallback_Int32
	RadixPass16SignedInt64 = BaseRadixPass16Signed_fallback_Int64
	RadixPassSignedInt32 = BaseRadixPassSigned_fallback_Int32
	RadixPassSignedInt64 = BaseRadixPassSigned_fallback_Int64
}
