// Code generated by hwygen. DO NOT EDIT.
//go:build amd64 && goexperiment.simd

package sort

import (
	"os"

	"github.com/ajroetker/go-highway/hwy"
	"simd/archsimd"
)

var CompressPartition3WayFloat32 func(data []float32, pivot float32) (int, int)
var CompressPartition3WayFloat64 func(data []float64, pivot float64) (int, int)
var CompressPartition3WayInt32 func(data []int32, pivot int32) (int, int)
var CompressPartition3WayInt64 func(data []int64, pivot int64) (int, int)
var CompressPartitionFloat32 func(data []float32, pivot float32) int
var CompressPartitionFloat64 func(data []float64, pivot float64) int
var CompressPartitionInt32 func(data []int32, pivot int32) int
var CompressPartitionInt64 func(data []int64, pivot int64) int

// CompressPartition3Way is the generic API that dispatches to the appropriate SIMD implementation.
func CompressPartition3Way[T hwy.Lanes](data []T, pivot T) (int, int) {
	switch any(data).(type) {
	case []float32:
		return CompressPartition3WayFloat32(any(data).([]float32), any(pivot).(float32))
	case []float64:
		return CompressPartition3WayFloat64(any(data).([]float64), any(pivot).(float64))
	case []int32:
		return CompressPartition3WayInt32(any(data).([]int32), any(pivot).(int32))
	case []int64:
		return CompressPartition3WayInt64(any(data).([]int64), any(pivot).(int64))
	}
	panic("unreachable")
}

// CompressPartition is the generic API that dispatches to the appropriate SIMD implementation.
func CompressPartition[T hwy.Lanes](data []T, pivot T) int {
	switch any(data).(type) {
	case []float32:
		return CompressPartitionFloat32(any(data).([]float32), any(pivot).(float32))
	case []float64:
		return CompressPartitionFloat64(any(data).([]float64), any(pivot).(float64))
	case []int32:
		return CompressPartitionInt32(any(data).([]int32), any(pivot).(int32))
	case []int64:
		return CompressPartitionInt64(any(data).([]int64), any(pivot).(int64))
	}
	panic("unreachable")
}

func init() {
	if os.Getenv("HWY_NO_SIMD") != "" {
		initCompress_partitionFallback()
		return
	}
	if archsimd.X86.AVX2() {
		initCompress_partitionAVX2()
		return
	}
	if archsimd.X86.AVX512() {
		initCompress_partitionAVX512()
		return
	}
	initCompress_partitionFallback()
}

func initCompress_partitionAVX2() {
	CompressPartition3WayFloat32 = BaseCompressPartition3Way_avx2
	CompressPartition3WayFloat64 = BaseCompressPartition3Way_avx2_Float64
	CompressPartition3WayInt32 = BaseCompressPartition3Way_avx2_Int32
	CompressPartition3WayInt64 = BaseCompressPartition3Way_avx2_Int64
	CompressPartitionFloat32 = BaseCompressPartition_avx2
	CompressPartitionFloat64 = BaseCompressPartition_avx2_Float64
	CompressPartitionInt32 = BaseCompressPartition_avx2_Int32
	CompressPartitionInt64 = BaseCompressPartition_avx2_Int64
}

func initCompress_partitionAVX512() {
	CompressPartition3WayFloat32 = BaseCompressPartition3Way_avx512
	CompressPartition3WayFloat64 = BaseCompressPartition3Way_avx512_Float64
	CompressPartition3WayInt32 = BaseCompressPartition3Way_avx512_Int32
	CompressPartition3WayInt64 = BaseCompressPartition3Way_avx512_Int64
	CompressPartitionFloat32 = BaseCompressPartition_avx512
	CompressPartitionFloat64 = BaseCompressPartition_avx512_Float64
	CompressPartitionInt32 = BaseCompressPartition_avx512_Int32
	CompressPartitionInt64 = BaseCompressPartition_avx512_Int64
}

func initCompress_partitionFallback() {
	CompressPartition3WayFloat32 = BaseCompressPartition3Way_fallback
	CompressPartition3WayFloat64 = BaseCompressPartition3Way_fallback_Float64
	CompressPartition3WayInt32 = BaseCompressPartition3Way_fallback_Int32
	CompressPartition3WayInt64 = BaseCompressPartition3Way_fallback_Int64
	CompressPartitionFloat32 = BaseCompressPartition_fallback
	CompressPartitionFloat64 = BaseCompressPartition_fallback_Float64
	CompressPartitionInt32 = BaseCompressPartition_fallback_Int32
	CompressPartitionInt64 = BaseCompressPartition_fallback_Int64
}
