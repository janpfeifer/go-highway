// Code generated by github.com/ajroetker/go-highway/cmd/hwygen. DO NOT EDIT.

//go:build amd64 && goexperiment.simd

package algo

import (
	"simd/archsimd"
	"unsafe"

	"github.com/ajroetker/go-highway/hwy"
)

func BasePrefixSum_avx2(data []float32) {
	n := len(data)
	if n == 0 {
		return
	}
	lanes := 8
	carry := float32(0)
	i := 0
	for ; i+lanes*2 <= n; i += lanes * 2 {
		v := archsimd.LoadFloat32x8((*[8]float32)(unsafe.Pointer(&data[i])))
		prefixed := BasePrefixSumVec_avx2(v)
		prefixed = prefixed.Add(archsimd.BroadcastFloat32x8(carry))
		prefixed.Store((*[8]float32)(unsafe.Pointer(&data[i])))
		carry = hwy.GetLane_AVX2_F32x8(prefixed, lanes-1)
		v1 := archsimd.LoadFloat32x8((*[8]float32)(unsafe.Pointer(&data[i+8])))
		prefixed1 := BasePrefixSumVec_avx2(v1)
		prefixed1 = prefixed1.Add(archsimd.BroadcastFloat32x8(carry))
		prefixed1.Store((*[8]float32)(unsafe.Pointer(&data[i+8])))
		carry = hwy.GetLane_AVX2_F32x8(prefixed1, lanes-1)
	}
	for ; i < n; i++ {
		carry += data[i]
		data[i] = carry
	}
}

func BasePrefixSum_avx2_Float64(data []float64) {
	n := len(data)
	if n == 0 {
		return
	}
	lanes := 4
	carry := float64(0)
	i := 0
	for ; i+lanes*2 <= n; i += lanes * 2 {
		v := archsimd.LoadFloat64x4((*[4]float64)(unsafe.Pointer(&data[i])))
		prefixed := BasePrefixSumVec_avx2_Float64(v)
		prefixed = prefixed.Add(archsimd.BroadcastFloat64x4(carry))
		prefixed.Store((*[4]float64)(unsafe.Pointer(&data[i])))
		carry = hwy.GetLane_AVX2_F64x4(prefixed, lanes-1)
		v1 := archsimd.LoadFloat64x4((*[4]float64)(unsafe.Pointer(&data[i+4])))
		prefixed1 := BasePrefixSumVec_avx2_Float64(v1)
		prefixed1 = prefixed1.Add(archsimd.BroadcastFloat64x4(carry))
		prefixed1.Store((*[4]float64)(unsafe.Pointer(&data[i+4])))
		carry = hwy.GetLane_AVX2_F64x4(prefixed1, lanes-1)
	}
	for ; i < n; i++ {
		carry += data[i]
		data[i] = carry
	}
}

func BasePrefixSum_avx2_Int32(data []int32) {
	n := len(data)
	if n == 0 {
		return
	}
	lanes := 8
	carry := int32(0)
	i := 0
	for ; i+lanes*2 <= n; i += lanes * 2 {
		v := archsimd.LoadInt32x8((*[8]int32)(unsafe.Pointer(&data[i])))
		prefixed := BasePrefixSumVec_avx2_Int32(v)
		prefixed = prefixed.Add(archsimd.BroadcastInt32x8(carry))
		prefixed.Store((*[8]int32)(unsafe.Pointer(&data[i])))
		carry = hwy.GetLane_AVX2_I32x8(prefixed, lanes-1)
		v1 := archsimd.LoadInt32x8((*[8]int32)(unsafe.Pointer(&data[i+8])))
		prefixed1 := BasePrefixSumVec_avx2_Int32(v1)
		prefixed1 = prefixed1.Add(archsimd.BroadcastInt32x8(carry))
		prefixed1.Store((*[8]int32)(unsafe.Pointer(&data[i+8])))
		carry = hwy.GetLane_AVX2_I32x8(prefixed1, lanes-1)
	}
	for ; i < n; i++ {
		carry += data[i]
		data[i] = carry
	}
}

func BasePrefixSum_avx2_Int64(data []int64) {
	n := len(data)
	if n == 0 {
		return
	}
	lanes := 4
	carry := int64(0)
	i := 0
	for ; i+lanes*2 <= n; i += lanes * 2 {
		v := archsimd.LoadInt64x4((*[4]int64)(unsafe.Pointer(&data[i])))
		prefixed := BasePrefixSumVec_avx2_Int64(v)
		prefixed = prefixed.Add(archsimd.BroadcastInt64x4(carry))
		prefixed.Store((*[4]int64)(unsafe.Pointer(&data[i])))
		carry = hwy.GetLane_AVX2_I64x4(prefixed, lanes-1)
		v1 := archsimd.LoadInt64x4((*[4]int64)(unsafe.Pointer(&data[i+4])))
		prefixed1 := BasePrefixSumVec_avx2_Int64(v1)
		prefixed1 = prefixed1.Add(archsimd.BroadcastInt64x4(carry))
		prefixed1.Store((*[4]int64)(unsafe.Pointer(&data[i+4])))
		carry = hwy.GetLane_AVX2_I64x4(prefixed1, lanes-1)
	}
	for ; i < n; i++ {
		carry += data[i]
		data[i] = carry
	}
}

func BasePrefixSum_avx2_Uint32(data []uint32) {
	n := len(data)
	if n == 0 {
		return
	}
	lanes := 8
	carry := uint32(0)
	i := 0
	for ; i+lanes*2 <= n; i += lanes * 2 {
		v := archsimd.LoadUint32x8((*[8]uint32)(unsafe.Pointer(&data[i])))
		prefixed := BasePrefixSumVec_avx2_Uint32(v)
		prefixed = prefixed.Add(archsimd.BroadcastUint32x8(carry))
		prefixed.Store((*[8]uint32)(unsafe.Pointer(&data[i])))
		carry = hwy.GetLane_AVX2_Uint32x8(prefixed, lanes-1)
		v1 := archsimd.LoadUint32x8((*[8]uint32)(unsafe.Pointer(&data[i+8])))
		prefixed1 := BasePrefixSumVec_avx2_Uint32(v1)
		prefixed1 = prefixed1.Add(archsimd.BroadcastUint32x8(carry))
		prefixed1.Store((*[8]uint32)(unsafe.Pointer(&data[i+8])))
		carry = hwy.GetLane_AVX2_Uint32x8(prefixed1, lanes-1)
	}
	for ; i < n; i++ {
		carry += data[i]
		data[i] = carry
	}
}

func BasePrefixSum_avx2_Uint64(data []uint64) {
	n := len(data)
	if n == 0 {
		return
	}
	lanes := 4
	carry := uint64(0)
	i := 0
	for ; i+lanes*2 <= n; i += lanes * 2 {
		v := archsimd.LoadUint64x4((*[4]uint64)(unsafe.Pointer(&data[i])))
		prefixed := BasePrefixSumVec_avx2_Uint64(v)
		prefixed = prefixed.Add(archsimd.BroadcastUint64x4(carry))
		prefixed.Store((*[4]uint64)(unsafe.Pointer(&data[i])))
		carry = hwy.GetLane_AVX2_Uint64x4(prefixed, lanes-1)
		v1 := archsimd.LoadUint64x4((*[4]uint64)(unsafe.Pointer(&data[i+4])))
		prefixed1 := BasePrefixSumVec_avx2_Uint64(v1)
		prefixed1 = prefixed1.Add(archsimd.BroadcastUint64x4(carry))
		prefixed1.Store((*[4]uint64)(unsafe.Pointer(&data[i+4])))
		carry = hwy.GetLane_AVX2_Uint64x4(prefixed1, lanes-1)
	}
	for ; i < n; i++ {
		carry += data[i]
		data[i] = carry
	}
}

func BaseDeltaDecode_avx2_Int32(data []int32, base int32) {
	n := len(data)
	if n == 0 {
		return
	}
	lanes := 8
	carry := base
	i := 0
	for ; i+lanes*2 <= n; i += lanes * 2 {
		v := archsimd.LoadInt32x8((*[8]int32)(unsafe.Pointer(&data[i])))
		prefixed := BasePrefixSumVec_avx2_Int32(v)
		prefixed = prefixed.Add(archsimd.BroadcastInt32x8(carry))
		prefixed.Store((*[8]int32)(unsafe.Pointer(&data[i])))
		carry = hwy.GetLane_AVX2_I32x8(prefixed, lanes-1)
		v1 := archsimd.LoadInt32x8((*[8]int32)(unsafe.Pointer(&data[i+8])))
		prefixed1 := BasePrefixSumVec_avx2_Int32(v1)
		prefixed1 = prefixed1.Add(archsimd.BroadcastInt32x8(carry))
		prefixed1.Store((*[8]int32)(unsafe.Pointer(&data[i+8])))
		carry = hwy.GetLane_AVX2_I32x8(prefixed1, lanes-1)
	}
	for ; i < n; i++ {
		carry += data[i]
		data[i] = carry
	}
}

func BaseDeltaDecode_avx2_Int64(data []int64, base int64) {
	n := len(data)
	if n == 0 {
		return
	}
	lanes := 4
	carry := base
	i := 0
	for ; i+lanes*2 <= n; i += lanes * 2 {
		v := archsimd.LoadInt64x4((*[4]int64)(unsafe.Pointer(&data[i])))
		prefixed := BasePrefixSumVec_avx2_Int64(v)
		prefixed = prefixed.Add(archsimd.BroadcastInt64x4(carry))
		prefixed.Store((*[4]int64)(unsafe.Pointer(&data[i])))
		carry = hwy.GetLane_AVX2_I64x4(prefixed, lanes-1)
		v1 := archsimd.LoadInt64x4((*[4]int64)(unsafe.Pointer(&data[i+4])))
		prefixed1 := BasePrefixSumVec_avx2_Int64(v1)
		prefixed1 = prefixed1.Add(archsimd.BroadcastInt64x4(carry))
		prefixed1.Store((*[4]int64)(unsafe.Pointer(&data[i+4])))
		carry = hwy.GetLane_AVX2_I64x4(prefixed1, lanes-1)
	}
	for ; i < n; i++ {
		carry += data[i]
		data[i] = carry
	}
}

func BaseDeltaDecode_avx2_Uint32(data []uint32, base uint32) {
	n := len(data)
	if n == 0 {
		return
	}
	lanes := 8
	carry := base
	i := 0
	for ; i+lanes*2 <= n; i += lanes * 2 {
		v := archsimd.LoadUint32x8((*[8]uint32)(unsafe.Pointer(&data[i])))
		prefixed := BasePrefixSumVec_avx2_Uint32(v)
		prefixed = prefixed.Add(archsimd.BroadcastUint32x8(carry))
		prefixed.Store((*[8]uint32)(unsafe.Pointer(&data[i])))
		carry = hwy.GetLane_AVX2_Uint32x8(prefixed, lanes-1)
		v1 := archsimd.LoadUint32x8((*[8]uint32)(unsafe.Pointer(&data[i+8])))
		prefixed1 := BasePrefixSumVec_avx2_Uint32(v1)
		prefixed1 = prefixed1.Add(archsimd.BroadcastUint32x8(carry))
		prefixed1.Store((*[8]uint32)(unsafe.Pointer(&data[i+8])))
		carry = hwy.GetLane_AVX2_Uint32x8(prefixed1, lanes-1)
	}
	for ; i < n; i++ {
		carry += data[i]
		data[i] = carry
	}
}

func BaseDeltaDecode_avx2_Uint64(data []uint64, base uint64) {
	n := len(data)
	if n == 0 {
		return
	}
	lanes := 4
	carry := base
	i := 0
	for ; i+lanes*2 <= n; i += lanes * 2 {
		v := archsimd.LoadUint64x4((*[4]uint64)(unsafe.Pointer(&data[i])))
		prefixed := BasePrefixSumVec_avx2_Uint64(v)
		prefixed = prefixed.Add(archsimd.BroadcastUint64x4(carry))
		prefixed.Store((*[4]uint64)(unsafe.Pointer(&data[i])))
		carry = hwy.GetLane_AVX2_Uint64x4(prefixed, lanes-1)
		v1 := archsimd.LoadUint64x4((*[4]uint64)(unsafe.Pointer(&data[i+4])))
		prefixed1 := BasePrefixSumVec_avx2_Uint64(v1)
		prefixed1 = prefixed1.Add(archsimd.BroadcastUint64x4(carry))
		prefixed1.Store((*[4]uint64)(unsafe.Pointer(&data[i+4])))
		carry = hwy.GetLane_AVX2_Uint64x4(prefixed1, lanes-1)
	}
	for ; i < n; i++ {
		carry += data[i]
		data[i] = carry
	}
}

func BasePrefixSumVec_avx2(v archsimd.Float32x8) archsimd.Float32x8 {
	n := 8
	if n >= 2 {
		v = v.Add(hwy.SlideUpLanes_AVX2_F32x8(v, 1))
	}
	if n >= 4 {
		v = v.Add(hwy.SlideUpLanes_AVX2_F32x8(v, 2))
	}
	if n >= 8 {
		v = v.Add(hwy.SlideUpLanes_AVX2_F32x8(v, 4))
	}
	if n >= 16 {
		v = v.Add(hwy.SlideUpLanes_AVX2_F32x8(v, 8))
	}
	return v
}

func BasePrefixSumVec_avx2_Float64(v archsimd.Float64x4) archsimd.Float64x4 {
	n := 4
	if n >= 2 {
		v = v.Add(hwy.SlideUpLanes_AVX2_F64x4(v, 1))
	}
	if n >= 4 {
		v = v.Add(hwy.SlideUpLanes_AVX2_F64x4(v, 2))
	}
	if n >= 8 {
		v = v.Add(hwy.SlideUpLanes_AVX2_F64x4(v, 4))
	}
	if n >= 16 {
		v = v.Add(hwy.SlideUpLanes_AVX2_F64x4(v, 8))
	}
	return v
}

func BasePrefixSumVec_avx2_Int32(v archsimd.Int32x8) archsimd.Int32x8 {
	n := 8
	if n >= 2 {
		v = v.Add(hwy.SlideUpLanes_AVX2_I32x8(v, 1))
	}
	if n >= 4 {
		v = v.Add(hwy.SlideUpLanes_AVX2_I32x8(v, 2))
	}
	if n >= 8 {
		v = v.Add(hwy.SlideUpLanes_AVX2_I32x8(v, 4))
	}
	if n >= 16 {
		v = v.Add(hwy.SlideUpLanes_AVX2_I32x8(v, 8))
	}
	return v
}

func BasePrefixSumVec_avx2_Int64(v archsimd.Int64x4) archsimd.Int64x4 {
	n := 4
	if n >= 2 {
		v = v.Add(hwy.SlideUpLanes_AVX2_I64x4(v, 1))
	}
	if n >= 4 {
		v = v.Add(hwy.SlideUpLanes_AVX2_I64x4(v, 2))
	}
	if n >= 8 {
		v = v.Add(hwy.SlideUpLanes_AVX2_I64x4(v, 4))
	}
	if n >= 16 {
		v = v.Add(hwy.SlideUpLanes_AVX2_I64x4(v, 8))
	}
	return v
}

func BasePrefixSumVec_avx2_Uint32(v archsimd.Uint32x8) archsimd.Uint32x8 {
	n := 8
	if n >= 2 {
		v = v.Add(hwy.SlideUpLanes_AVX2_Uint32x8(v, 1))
	}
	if n >= 4 {
		v = v.Add(hwy.SlideUpLanes_AVX2_Uint32x8(v, 2))
	}
	if n >= 8 {
		v = v.Add(hwy.SlideUpLanes_AVX2_Uint32x8(v, 4))
	}
	if n >= 16 {
		v = v.Add(hwy.SlideUpLanes_AVX2_Uint32x8(v, 8))
	}
	return v
}

func BasePrefixSumVec_avx2_Uint64(v archsimd.Uint64x4) archsimd.Uint64x4 {
	n := 4
	if n >= 2 {
		v = v.Add(hwy.SlideUpLanes_AVX2_Uint64x4(v, 1))
	}
	if n >= 4 {
		v = v.Add(hwy.SlideUpLanes_AVX2_Uint64x4(v, 2))
	}
	if n >= 8 {
		v = v.Add(hwy.SlideUpLanes_AVX2_Uint64x4(v, 4))
	}
	if n >= 16 {
		v = v.Add(hwy.SlideUpLanes_AVX2_Uint64x4(v, 8))
	}
	return v
}
