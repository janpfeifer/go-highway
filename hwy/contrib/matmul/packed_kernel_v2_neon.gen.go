// Code generated by github.com/ajroetker/go-highway/cmd/hwygen. DO NOT EDIT.

//go:build arm64

package matmul

import (
	"unsafe"

	"github.com/ajroetker/go-highway/hwy"
	"github.com/ajroetker/go-highway/hwy/asm"
)

func BasePackedMicroKernel4x2_neon_Float16(packedA []hwy.Float16, packedB []hwy.Float16, output []hwy.Float16, outputStride int, outRowStart int, outColStart int, panelK int, lanes int) {
	acc00 := asm.ZeroFloat16x8()
	acc01 := asm.ZeroFloat16x8()
	acc10 := asm.ZeroFloat16x8()
	acc11 := asm.ZeroFloat16x8()
	acc20 := asm.ZeroFloat16x8()
	acc21 := asm.ZeroFloat16x8()
	acc30 := asm.ZeroFloat16x8()
	acc31 := asm.ZeroFloat16x8()
	nr := 2 * lanes
	mr := 4
	aIdx := 0
	bIdx := 0
	_ = packedA[panelK*mr-1].Float32()
	_ = packedB[panelK*nr-1].Float32()
	p := 0
	for ; p+3 < panelK; p += 4 {
		bVec0_0 := asm.LoadFloat16x8Ptr(unsafe.Pointer(&packedB[bIdx:][0]))
		bVec1_0 := asm.LoadFloat16x8Ptr(unsafe.Pointer(&packedB[bIdx+lanes:][0]))
		a0_0 := asm.BroadcastFloat16x8(uint16(packedA[aIdx]))
		a1_0 := asm.BroadcastFloat16x8(uint16(packedA[aIdx+1]))
		a2_0 := asm.BroadcastFloat16x8(uint16(packedA[aIdx+2]))
		a3_0 := asm.BroadcastFloat16x8(uint16(packedA[aIdx+3]))
		a0_0.MulAddAcc(bVec0_0, &acc00)
		a0_0.MulAddAcc(bVec1_0, &acc01)
		a1_0.MulAddAcc(bVec0_0, &acc10)
		a1_0.MulAddAcc(bVec1_0, &acc11)
		a2_0.MulAddAcc(bVec0_0, &acc20)
		a2_0.MulAddAcc(bVec1_0, &acc21)
		a3_0.MulAddAcc(bVec0_0, &acc30)
		a3_0.MulAddAcc(bVec1_0, &acc31)
		bVec0_1 := asm.LoadFloat16x8Ptr(unsafe.Pointer(&packedB[bIdx+nr:][0]))
		bVec1_1 := asm.LoadFloat16x8Ptr(unsafe.Pointer(&packedB[bIdx+nr+lanes:][0]))
		a0_1 := asm.BroadcastFloat16x8(uint16(packedA[aIdx+mr]))
		a1_1 := asm.BroadcastFloat16x8(uint16(packedA[aIdx+mr+1]))
		a2_1 := asm.BroadcastFloat16x8(uint16(packedA[aIdx+mr+2]))
		a3_1 := asm.BroadcastFloat16x8(uint16(packedA[aIdx+mr+3]))
		a0_1.MulAddAcc(bVec0_1, &acc00)
		a0_1.MulAddAcc(bVec1_1, &acc01)
		a1_1.MulAddAcc(bVec0_1, &acc10)
		a1_1.MulAddAcc(bVec1_1, &acc11)
		a2_1.MulAddAcc(bVec0_1, &acc20)
		a2_1.MulAddAcc(bVec1_1, &acc21)
		a3_1.MulAddAcc(bVec0_1, &acc30)
		a3_1.MulAddAcc(bVec1_1, &acc31)
		bVec0_2 := asm.LoadFloat16x8Ptr(unsafe.Pointer(&packedB[bIdx+2*nr:][0]))
		bVec1_2 := asm.LoadFloat16x8Ptr(unsafe.Pointer(&packedB[bIdx+2*nr+lanes:][0]))
		a0_2 := asm.BroadcastFloat16x8(uint16(packedA[aIdx+2*mr]))
		a1_2 := asm.BroadcastFloat16x8(uint16(packedA[aIdx+2*mr+1]))
		a2_2 := asm.BroadcastFloat16x8(uint16(packedA[aIdx+2*mr+2]))
		a3_2 := asm.BroadcastFloat16x8(uint16(packedA[aIdx+2*mr+3]))
		a0_2.MulAddAcc(bVec0_2, &acc00)
		a0_2.MulAddAcc(bVec1_2, &acc01)
		a1_2.MulAddAcc(bVec0_2, &acc10)
		a1_2.MulAddAcc(bVec1_2, &acc11)
		a2_2.MulAddAcc(bVec0_2, &acc20)
		a2_2.MulAddAcc(bVec1_2, &acc21)
		a3_2.MulAddAcc(bVec0_2, &acc30)
		a3_2.MulAddAcc(bVec1_2, &acc31)
		bVec0_3 := asm.LoadFloat16x8Ptr(unsafe.Pointer(&packedB[bIdx+3*nr:][0]))
		bVec1_3 := asm.LoadFloat16x8Ptr(unsafe.Pointer(&packedB[bIdx+3*nr+lanes:][0]))
		a0_3 := asm.BroadcastFloat16x8(uint16(packedA[aIdx+3*mr]))
		a1_3 := asm.BroadcastFloat16x8(uint16(packedA[aIdx+3*mr+1]))
		a2_3 := asm.BroadcastFloat16x8(uint16(packedA[aIdx+3*mr+2]))
		a3_3 := asm.BroadcastFloat16x8(uint16(packedA[aIdx+3*mr+3]))
		a0_3.MulAddAcc(bVec0_3, &acc00)
		a0_3.MulAddAcc(bVec1_3, &acc01)
		a1_3.MulAddAcc(bVec0_3, &acc10)
		a1_3.MulAddAcc(bVec1_3, &acc11)
		a2_3.MulAddAcc(bVec0_3, &acc20)
		a2_3.MulAddAcc(bVec1_3, &acc21)
		a3_3.MulAddAcc(bVec0_3, &acc30)
		a3_3.MulAddAcc(bVec1_3, &acc31)
		aIdx += 4 * mr
		bIdx += 4 * nr
	}
	for ; p < panelK; p++ {
		bVec0 := asm.LoadFloat16x8Ptr(unsafe.Pointer(&packedB[bIdx:][0]))
		bVec1 := asm.LoadFloat16x8Ptr(unsafe.Pointer(&packedB[bIdx+lanes:][0]))
		bIdx += nr
		a0 := asm.BroadcastFloat16x8(uint16(packedA[aIdx]))
		a1 := asm.BroadcastFloat16x8(uint16(packedA[aIdx+1]))
		a2 := asm.BroadcastFloat16x8(uint16(packedA[aIdx+2]))
		a3 := asm.BroadcastFloat16x8(uint16(packedA[aIdx+3]))
		aIdx += mr
		a0.MulAddAcc(bVec0, &acc00)
		a0.MulAddAcc(bVec1, &acc01)
		a1.MulAddAcc(bVec0, &acc10)
		a1.MulAddAcc(bVec1, &acc11)
		a2.MulAddAcc(bVec0, &acc20)
		a2.MulAddAcc(bVec1, &acc21)
		a3.MulAddAcc(bVec0, &acc30)
		a3.MulAddAcc(bVec1, &acc31)
	}
	outIdx0 := outRowStart*outputStride + outColStart
	outIdx1 := outIdx0 + outputStride
	outIdx2 := outIdx1 + outputStride
	outIdx3 := outIdx2 + outputStride
	acc00.StorePtr(unsafe.Pointer(&output[outIdx0:][0]))
	acc01.StorePtr(unsafe.Pointer(&output[outIdx0+lanes:][0]))
	acc10.StorePtr(unsafe.Pointer(&output[outIdx1:][0]))
	acc11.StorePtr(unsafe.Pointer(&output[outIdx1+lanes:][0]))
	acc20.StorePtr(unsafe.Pointer(&output[outIdx2:][0]))
	acc21.StorePtr(unsafe.Pointer(&output[outIdx2+lanes:][0]))
	acc30.StorePtr(unsafe.Pointer(&output[outIdx3:][0]))
	acc31.StorePtr(unsafe.Pointer(&output[outIdx3+lanes:][0]))
}

func BasePackedMicroKernel4x2_neon_BFloat16(packedA []hwy.BFloat16, packedB []hwy.BFloat16, output []hwy.BFloat16, outputStride int, outRowStart int, outColStart int, panelK int, lanes int) {
	acc00 := asm.ZeroBFloat16x8()
	acc01 := asm.ZeroBFloat16x8()
	acc10 := asm.ZeroBFloat16x8()
	acc11 := asm.ZeroBFloat16x8()
	acc20 := asm.ZeroBFloat16x8()
	acc21 := asm.ZeroBFloat16x8()
	acc30 := asm.ZeroBFloat16x8()
	acc31 := asm.ZeroBFloat16x8()
	nr := 2 * lanes
	mr := 4
	aIdx := 0
	bIdx := 0
	_ = packedA[panelK*mr-1].Float32()
	_ = packedB[panelK*nr-1].Float32()
	p := 0
	for ; p+3 < panelK; p += 4 {
		bVec0_0 := asm.LoadBFloat16x8Ptr(unsafe.Pointer(&packedB[bIdx:][0]))
		bVec1_0 := asm.LoadBFloat16x8Ptr(unsafe.Pointer(&packedB[bIdx+lanes:][0]))
		a0_0 := asm.BroadcastBFloat16x8(uint16(packedA[aIdx]))
		a1_0 := asm.BroadcastBFloat16x8(uint16(packedA[aIdx+1]))
		a2_0 := asm.BroadcastBFloat16x8(uint16(packedA[aIdx+2]))
		a3_0 := asm.BroadcastBFloat16x8(uint16(packedA[aIdx+3]))
		a0_0.MulAddAcc(bVec0_0, &acc00)
		a0_0.MulAddAcc(bVec1_0, &acc01)
		a1_0.MulAddAcc(bVec0_0, &acc10)
		a1_0.MulAddAcc(bVec1_0, &acc11)
		a2_0.MulAddAcc(bVec0_0, &acc20)
		a2_0.MulAddAcc(bVec1_0, &acc21)
		a3_0.MulAddAcc(bVec0_0, &acc30)
		a3_0.MulAddAcc(bVec1_0, &acc31)
		bVec0_1 := asm.LoadBFloat16x8Ptr(unsafe.Pointer(&packedB[bIdx+nr:][0]))
		bVec1_1 := asm.LoadBFloat16x8Ptr(unsafe.Pointer(&packedB[bIdx+nr+lanes:][0]))
		a0_1 := asm.BroadcastBFloat16x8(uint16(packedA[aIdx+mr]))
		a1_1 := asm.BroadcastBFloat16x8(uint16(packedA[aIdx+mr+1]))
		a2_1 := asm.BroadcastBFloat16x8(uint16(packedA[aIdx+mr+2]))
		a3_1 := asm.BroadcastBFloat16x8(uint16(packedA[aIdx+mr+3]))
		a0_1.MulAddAcc(bVec0_1, &acc00)
		a0_1.MulAddAcc(bVec1_1, &acc01)
		a1_1.MulAddAcc(bVec0_1, &acc10)
		a1_1.MulAddAcc(bVec1_1, &acc11)
		a2_1.MulAddAcc(bVec0_1, &acc20)
		a2_1.MulAddAcc(bVec1_1, &acc21)
		a3_1.MulAddAcc(bVec0_1, &acc30)
		a3_1.MulAddAcc(bVec1_1, &acc31)
		bVec0_2 := asm.LoadBFloat16x8Ptr(unsafe.Pointer(&packedB[bIdx+2*nr:][0]))
		bVec1_2 := asm.LoadBFloat16x8Ptr(unsafe.Pointer(&packedB[bIdx+2*nr+lanes:][0]))
		a0_2 := asm.BroadcastBFloat16x8(uint16(packedA[aIdx+2*mr]))
		a1_2 := asm.BroadcastBFloat16x8(uint16(packedA[aIdx+2*mr+1]))
		a2_2 := asm.BroadcastBFloat16x8(uint16(packedA[aIdx+2*mr+2]))
		a3_2 := asm.BroadcastBFloat16x8(uint16(packedA[aIdx+2*mr+3]))
		a0_2.MulAddAcc(bVec0_2, &acc00)
		a0_2.MulAddAcc(bVec1_2, &acc01)
		a1_2.MulAddAcc(bVec0_2, &acc10)
		a1_2.MulAddAcc(bVec1_2, &acc11)
		a2_2.MulAddAcc(bVec0_2, &acc20)
		a2_2.MulAddAcc(bVec1_2, &acc21)
		a3_2.MulAddAcc(bVec0_2, &acc30)
		a3_2.MulAddAcc(bVec1_2, &acc31)
		bVec0_3 := asm.LoadBFloat16x8Ptr(unsafe.Pointer(&packedB[bIdx+3*nr:][0]))
		bVec1_3 := asm.LoadBFloat16x8Ptr(unsafe.Pointer(&packedB[bIdx+3*nr+lanes:][0]))
		a0_3 := asm.BroadcastBFloat16x8(uint16(packedA[aIdx+3*mr]))
		a1_3 := asm.BroadcastBFloat16x8(uint16(packedA[aIdx+3*mr+1]))
		a2_3 := asm.BroadcastBFloat16x8(uint16(packedA[aIdx+3*mr+2]))
		a3_3 := asm.BroadcastBFloat16x8(uint16(packedA[aIdx+3*mr+3]))
		a0_3.MulAddAcc(bVec0_3, &acc00)
		a0_3.MulAddAcc(bVec1_3, &acc01)
		a1_3.MulAddAcc(bVec0_3, &acc10)
		a1_3.MulAddAcc(bVec1_3, &acc11)
		a2_3.MulAddAcc(bVec0_3, &acc20)
		a2_3.MulAddAcc(bVec1_3, &acc21)
		a3_3.MulAddAcc(bVec0_3, &acc30)
		a3_3.MulAddAcc(bVec1_3, &acc31)
		aIdx += 4 * mr
		bIdx += 4 * nr
	}
	for ; p < panelK; p++ {
		bVec0 := asm.LoadBFloat16x8Ptr(unsafe.Pointer(&packedB[bIdx:][0]))
		bVec1 := asm.LoadBFloat16x8Ptr(unsafe.Pointer(&packedB[bIdx+lanes:][0]))
		bIdx += nr
		a0 := asm.BroadcastBFloat16x8(uint16(packedA[aIdx]))
		a1 := asm.BroadcastBFloat16x8(uint16(packedA[aIdx+1]))
		a2 := asm.BroadcastBFloat16x8(uint16(packedA[aIdx+2]))
		a3 := asm.BroadcastBFloat16x8(uint16(packedA[aIdx+3]))
		aIdx += mr
		a0.MulAddAcc(bVec0, &acc00)
		a0.MulAddAcc(bVec1, &acc01)
		a1.MulAddAcc(bVec0, &acc10)
		a1.MulAddAcc(bVec1, &acc11)
		a2.MulAddAcc(bVec0, &acc20)
		a2.MulAddAcc(bVec1, &acc21)
		a3.MulAddAcc(bVec0, &acc30)
		a3.MulAddAcc(bVec1, &acc31)
	}
	outIdx0 := outRowStart*outputStride + outColStart
	outIdx1 := outIdx0 + outputStride
	outIdx2 := outIdx1 + outputStride
	outIdx3 := outIdx2 + outputStride
	acc00.StorePtr(unsafe.Pointer(&output[outIdx0:][0]))
	acc01.StorePtr(unsafe.Pointer(&output[outIdx0+lanes:][0]))
	acc10.StorePtr(unsafe.Pointer(&output[outIdx1:][0]))
	acc11.StorePtr(unsafe.Pointer(&output[outIdx1+lanes:][0]))
	acc20.StorePtr(unsafe.Pointer(&output[outIdx2:][0]))
	acc21.StorePtr(unsafe.Pointer(&output[outIdx2+lanes:][0]))
	acc30.StorePtr(unsafe.Pointer(&output[outIdx3:][0]))
	acc31.StorePtr(unsafe.Pointer(&output[outIdx3+lanes:][0]))
}

func BasePackedMicroKernel4x2_neon(packedA []float32, packedB []float32, output []float32, outputStride int, outRowStart int, outColStart int, panelK int, lanes int) {
	acc00 := asm.ZeroFloat32x4()
	acc01 := asm.ZeroFloat32x4()
	acc10 := asm.ZeroFloat32x4()
	acc11 := asm.ZeroFloat32x4()
	acc20 := asm.ZeroFloat32x4()
	acc21 := asm.ZeroFloat32x4()
	acc30 := asm.ZeroFloat32x4()
	acc31 := asm.ZeroFloat32x4()
	nr := 2 * lanes
	mr := 4
	aIdx := 0
	bIdx := 0
	_ = packedA[panelK*mr-1]
	_ = packedB[panelK*nr-1]
	p := 0
	for ; p+3 < panelK; p += 4 {
		bVec0_0 := asm.LoadFloat32x4Slice(packedB[bIdx:])
		bVec1_0 := asm.LoadFloat32x4Slice(packedB[bIdx+lanes:])
		a0_0 := asm.BroadcastFloat32x4(packedA[aIdx])
		a1_0 := asm.BroadcastFloat32x4(packedA[aIdx+1])
		a2_0 := asm.BroadcastFloat32x4(packedA[aIdx+2])
		a3_0 := asm.BroadcastFloat32x4(packedA[aIdx+3])
		a0_0.MulAddAcc(bVec0_0, &acc00)
		a0_0.MulAddAcc(bVec1_0, &acc01)
		a1_0.MulAddAcc(bVec0_0, &acc10)
		a1_0.MulAddAcc(bVec1_0, &acc11)
		a2_0.MulAddAcc(bVec0_0, &acc20)
		a2_0.MulAddAcc(bVec1_0, &acc21)
		a3_0.MulAddAcc(bVec0_0, &acc30)
		a3_0.MulAddAcc(bVec1_0, &acc31)
		bVec0_1 := asm.LoadFloat32x4Slice(packedB[bIdx+nr:])
		bVec1_1 := asm.LoadFloat32x4Slice(packedB[bIdx+nr+lanes:])
		a0_1 := asm.BroadcastFloat32x4(packedA[aIdx+mr])
		a1_1 := asm.BroadcastFloat32x4(packedA[aIdx+mr+1])
		a2_1 := asm.BroadcastFloat32x4(packedA[aIdx+mr+2])
		a3_1 := asm.BroadcastFloat32x4(packedA[aIdx+mr+3])
		a0_1.MulAddAcc(bVec0_1, &acc00)
		a0_1.MulAddAcc(bVec1_1, &acc01)
		a1_1.MulAddAcc(bVec0_1, &acc10)
		a1_1.MulAddAcc(bVec1_1, &acc11)
		a2_1.MulAddAcc(bVec0_1, &acc20)
		a2_1.MulAddAcc(bVec1_1, &acc21)
		a3_1.MulAddAcc(bVec0_1, &acc30)
		a3_1.MulAddAcc(bVec1_1, &acc31)
		bVec0_2 := asm.LoadFloat32x4Slice(packedB[bIdx+2*nr:])
		bVec1_2 := asm.LoadFloat32x4Slice(packedB[bIdx+2*nr+lanes:])
		a0_2 := asm.BroadcastFloat32x4(packedA[aIdx+2*mr])
		a1_2 := asm.BroadcastFloat32x4(packedA[aIdx+2*mr+1])
		a2_2 := asm.BroadcastFloat32x4(packedA[aIdx+2*mr+2])
		a3_2 := asm.BroadcastFloat32x4(packedA[aIdx+2*mr+3])
		a0_2.MulAddAcc(bVec0_2, &acc00)
		a0_2.MulAddAcc(bVec1_2, &acc01)
		a1_2.MulAddAcc(bVec0_2, &acc10)
		a1_2.MulAddAcc(bVec1_2, &acc11)
		a2_2.MulAddAcc(bVec0_2, &acc20)
		a2_2.MulAddAcc(bVec1_2, &acc21)
		a3_2.MulAddAcc(bVec0_2, &acc30)
		a3_2.MulAddAcc(bVec1_2, &acc31)
		bVec0_3 := asm.LoadFloat32x4Slice(packedB[bIdx+3*nr:])
		bVec1_3 := asm.LoadFloat32x4Slice(packedB[bIdx+3*nr+lanes:])
		a0_3 := asm.BroadcastFloat32x4(packedA[aIdx+3*mr])
		a1_3 := asm.BroadcastFloat32x4(packedA[aIdx+3*mr+1])
		a2_3 := asm.BroadcastFloat32x4(packedA[aIdx+3*mr+2])
		a3_3 := asm.BroadcastFloat32x4(packedA[aIdx+3*mr+3])
		a0_3.MulAddAcc(bVec0_3, &acc00)
		a0_3.MulAddAcc(bVec1_3, &acc01)
		a1_3.MulAddAcc(bVec0_3, &acc10)
		a1_3.MulAddAcc(bVec1_3, &acc11)
		a2_3.MulAddAcc(bVec0_3, &acc20)
		a2_3.MulAddAcc(bVec1_3, &acc21)
		a3_3.MulAddAcc(bVec0_3, &acc30)
		a3_3.MulAddAcc(bVec1_3, &acc31)
		aIdx += 4 * mr
		bIdx += 4 * nr
	}
	for ; p < panelK; p++ {
		bVec0 := asm.LoadFloat32x4Slice(packedB[bIdx:])
		bVec1 := asm.LoadFloat32x4Slice(packedB[bIdx+lanes:])
		bIdx += nr
		a0 := asm.BroadcastFloat32x4(packedA[aIdx])
		a1 := asm.BroadcastFloat32x4(packedA[aIdx+1])
		a2 := asm.BroadcastFloat32x4(packedA[aIdx+2])
		a3 := asm.BroadcastFloat32x4(packedA[aIdx+3])
		aIdx += mr
		a0.MulAddAcc(bVec0, &acc00)
		a0.MulAddAcc(bVec1, &acc01)
		a1.MulAddAcc(bVec0, &acc10)
		a1.MulAddAcc(bVec1, &acc11)
		a2.MulAddAcc(bVec0, &acc20)
		a2.MulAddAcc(bVec1, &acc21)
		a3.MulAddAcc(bVec0, &acc30)
		a3.MulAddAcc(bVec1, &acc31)
	}
	outIdx0 := outRowStart*outputStride + outColStart
	outIdx1 := outIdx0 + outputStride
	outIdx2 := outIdx1 + outputStride
	outIdx3 := outIdx2 + outputStride
	acc00.StoreSlice(output[outIdx0:])
	acc01.StoreSlice(output[outIdx0+lanes:])
	acc10.StoreSlice(output[outIdx1:])
	acc11.StoreSlice(output[outIdx1+lanes:])
	acc20.StoreSlice(output[outIdx2:])
	acc21.StoreSlice(output[outIdx2+lanes:])
	acc30.StoreSlice(output[outIdx3:])
	acc31.StoreSlice(output[outIdx3+lanes:])
}

func BasePackedMicroKernel4x2_neon_Float64(packedA []float64, packedB []float64, output []float64, outputStride int, outRowStart int, outColStart int, panelK int, lanes int) {
	acc00 := asm.ZeroFloat64x2()
	acc01 := asm.ZeroFloat64x2()
	acc10 := asm.ZeroFloat64x2()
	acc11 := asm.ZeroFloat64x2()
	acc20 := asm.ZeroFloat64x2()
	acc21 := asm.ZeroFloat64x2()
	acc30 := asm.ZeroFloat64x2()
	acc31 := asm.ZeroFloat64x2()
	nr := 2 * lanes
	mr := 4
	aIdx := 0
	bIdx := 0
	_ = packedA[panelK*mr-1]
	_ = packedB[panelK*nr-1]
	p := 0
	for ; p+3 < panelK; p += 4 {
		bVec0_0 := asm.LoadFloat64x2Slice(packedB[bIdx:])
		bVec1_0 := asm.LoadFloat64x2Slice(packedB[bIdx+lanes:])
		a0_0 := asm.BroadcastFloat64x2(packedA[aIdx])
		a1_0 := asm.BroadcastFloat64x2(packedA[aIdx+1])
		a2_0 := asm.BroadcastFloat64x2(packedA[aIdx+2])
		a3_0 := asm.BroadcastFloat64x2(packedA[aIdx+3])
		a0_0.MulAddAcc(bVec0_0, &acc00)
		a0_0.MulAddAcc(bVec1_0, &acc01)
		a1_0.MulAddAcc(bVec0_0, &acc10)
		a1_0.MulAddAcc(bVec1_0, &acc11)
		a2_0.MulAddAcc(bVec0_0, &acc20)
		a2_0.MulAddAcc(bVec1_0, &acc21)
		a3_0.MulAddAcc(bVec0_0, &acc30)
		a3_0.MulAddAcc(bVec1_0, &acc31)
		bVec0_1 := asm.LoadFloat64x2Slice(packedB[bIdx+nr:])
		bVec1_1 := asm.LoadFloat64x2Slice(packedB[bIdx+nr+lanes:])
		a0_1 := asm.BroadcastFloat64x2(packedA[aIdx+mr])
		a1_1 := asm.BroadcastFloat64x2(packedA[aIdx+mr+1])
		a2_1 := asm.BroadcastFloat64x2(packedA[aIdx+mr+2])
		a3_1 := asm.BroadcastFloat64x2(packedA[aIdx+mr+3])
		a0_1.MulAddAcc(bVec0_1, &acc00)
		a0_1.MulAddAcc(bVec1_1, &acc01)
		a1_1.MulAddAcc(bVec0_1, &acc10)
		a1_1.MulAddAcc(bVec1_1, &acc11)
		a2_1.MulAddAcc(bVec0_1, &acc20)
		a2_1.MulAddAcc(bVec1_1, &acc21)
		a3_1.MulAddAcc(bVec0_1, &acc30)
		a3_1.MulAddAcc(bVec1_1, &acc31)
		bVec0_2 := asm.LoadFloat64x2Slice(packedB[bIdx+2*nr:])
		bVec1_2 := asm.LoadFloat64x2Slice(packedB[bIdx+2*nr+lanes:])
		a0_2 := asm.BroadcastFloat64x2(packedA[aIdx+2*mr])
		a1_2 := asm.BroadcastFloat64x2(packedA[aIdx+2*mr+1])
		a2_2 := asm.BroadcastFloat64x2(packedA[aIdx+2*mr+2])
		a3_2 := asm.BroadcastFloat64x2(packedA[aIdx+2*mr+3])
		a0_2.MulAddAcc(bVec0_2, &acc00)
		a0_2.MulAddAcc(bVec1_2, &acc01)
		a1_2.MulAddAcc(bVec0_2, &acc10)
		a1_2.MulAddAcc(bVec1_2, &acc11)
		a2_2.MulAddAcc(bVec0_2, &acc20)
		a2_2.MulAddAcc(bVec1_2, &acc21)
		a3_2.MulAddAcc(bVec0_2, &acc30)
		a3_2.MulAddAcc(bVec1_2, &acc31)
		bVec0_3 := asm.LoadFloat64x2Slice(packedB[bIdx+3*nr:])
		bVec1_3 := asm.LoadFloat64x2Slice(packedB[bIdx+3*nr+lanes:])
		a0_3 := asm.BroadcastFloat64x2(packedA[aIdx+3*mr])
		a1_3 := asm.BroadcastFloat64x2(packedA[aIdx+3*mr+1])
		a2_3 := asm.BroadcastFloat64x2(packedA[aIdx+3*mr+2])
		a3_3 := asm.BroadcastFloat64x2(packedA[aIdx+3*mr+3])
		a0_3.MulAddAcc(bVec0_3, &acc00)
		a0_3.MulAddAcc(bVec1_3, &acc01)
		a1_3.MulAddAcc(bVec0_3, &acc10)
		a1_3.MulAddAcc(bVec1_3, &acc11)
		a2_3.MulAddAcc(bVec0_3, &acc20)
		a2_3.MulAddAcc(bVec1_3, &acc21)
		a3_3.MulAddAcc(bVec0_3, &acc30)
		a3_3.MulAddAcc(bVec1_3, &acc31)
		aIdx += 4 * mr
		bIdx += 4 * nr
	}
	for ; p < panelK; p++ {
		bVec0 := asm.LoadFloat64x2Slice(packedB[bIdx:])
		bVec1 := asm.LoadFloat64x2Slice(packedB[bIdx+lanes:])
		bIdx += nr
		a0 := asm.BroadcastFloat64x2(packedA[aIdx])
		a1 := asm.BroadcastFloat64x2(packedA[aIdx+1])
		a2 := asm.BroadcastFloat64x2(packedA[aIdx+2])
		a3 := asm.BroadcastFloat64x2(packedA[aIdx+3])
		aIdx += mr
		a0.MulAddAcc(bVec0, &acc00)
		a0.MulAddAcc(bVec1, &acc01)
		a1.MulAddAcc(bVec0, &acc10)
		a1.MulAddAcc(bVec1, &acc11)
		a2.MulAddAcc(bVec0, &acc20)
		a2.MulAddAcc(bVec1, &acc21)
		a3.MulAddAcc(bVec0, &acc30)
		a3.MulAddAcc(bVec1, &acc31)
	}
	outIdx0 := outRowStart*outputStride + outColStart
	outIdx1 := outIdx0 + outputStride
	outIdx2 := outIdx1 + outputStride
	outIdx3 := outIdx2 + outputStride
	acc00.StoreSlice(output[outIdx0:])
	acc01.StoreSlice(output[outIdx0+lanes:])
	acc10.StoreSlice(output[outIdx1:])
	acc11.StoreSlice(output[outIdx1+lanes:])
	acc20.StoreSlice(output[outIdx2:])
	acc21.StoreSlice(output[outIdx2+lanes:])
	acc30.StoreSlice(output[outIdx3:])
	acc31.StoreSlice(output[outIdx3+lanes:])
}

func BaseZeroSlice_neon_Float16(s []hwy.Float16, n int) {
	vZero := asm.ZeroFloat16x8()
	lanes := 8
	var idx int
	for idx = 0; idx+lanes <= n; idx += lanes {
		vZero.StorePtr(unsafe.Pointer(&s[idx:][0]))
	}
	for ; idx < n; idx++ {
		s[idx] = hwy.Float32ToFloat16(0)
	}
}

func BaseZeroSlice_neon_BFloat16(s []hwy.BFloat16, n int) {
	vZero := asm.ZeroBFloat16x8()
	lanes := 8
	var idx int
	for idx = 0; idx+lanes <= n; idx += lanes {
		vZero.StorePtr(unsafe.Pointer(&s[idx:][0]))
	}
	for ; idx < n; idx++ {
		s[idx] = hwy.Float32ToBFloat16(0)
	}
}

func BaseZeroSlice_neon(s []float32, n int) {
	vZero := asm.ZeroFloat32x4()
	lanes := 4
	var idx int
	for idx = 0; idx+lanes <= n; idx += lanes {
		vZero.StoreSlice(s[idx:])
	}
	for ; idx < n; idx++ {
		s[idx] = 0
	}
}

func BaseZeroSlice_neon_Float64(s []float64, n int) {
	vZero := asm.ZeroFloat64x2()
	lanes := 2
	var idx int
	for idx = 0; idx+lanes <= n; idx += lanes {
		vZero.StoreSlice(s[idx:])
	}
	for ; idx < n; idx++ {
		s[idx] = 0
	}
}
