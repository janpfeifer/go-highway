//go:build !noasm && arm64
// Code generated by GoAT. DO NOT EDIT.
// versions:
// 	clang   17.0.0 (clang-1700.0.13.5)
// 	objdump 17.0.0
// flags: -O3
// source: ../c/matmul_fused_nf4_neon_arm64.c

TEXT ·fused_nf4_matmul_neon(SB), $64-72
	MOVD input+0(FP), R0
	MOVD packed+8(FP), R1
	MOVD scales+16(FP), R2
	MOVD output+24(FP), R3
	MOVD pM+32(FP), R4
	MOVD pK+40(FP), R5
	MOVD pN+48(FP), R6
	MOVD pGroupSize+56(FP), R7
	MOVD pNumGroups+64(FP), R8
	MOVD R8, 0(RSP)
	WORD $0xf9400088           // ldr	x8, [x4]
	WORD $0xf100051f           // cmp	x8, #1
	BLT  BB0_14
	WORD $0xf94000c9           // ldr	x9, [x6]
	WORD $0xf100053f           // cmp	x9, #1
	BLT  BB0_14
	WORD $0xa90067fa           // stp	x26, x25, [sp, #-64]! [transformed]
	WORD $0xf94000aa           // ldr	x10, [x5]
	WORD $0xa9015ff8           // stp	x24, x23, [sp, #16]
	WORD $0xa90257f6           // stp	x22, x21, [sp, #32]
	WORD $0xf100015f           // cmp	x10, #0
	WORD $0xa9034ff4           // stp	x20, x19, [sp, #48]
	BLE  BB0_9
	WORD $0xf94023ec           // ldr	x12, [sp, #64]
	WORD $0xd37ef54e           // lsl	x14, x10, #2
	WORD $0xaa1f03eb           // mov	x11, xzr
	WORD $0x9000000f           // adrp	x15, nf4_table
	WORD $0x910001ef           // add	x15, x15, :lo12:nf4_table
	WORD $0xf940018d           // ldr	x13, [x12]
	WORD $0xf94000ec           // ldr	x12, [x7]
	WORD $0xd37ef5ad           // lsl	x13, x13, #2

BB0_4:
	WORD $0x9b097d70 // mul	x16, x11, x9
	WORD $0xaa1f03f1 // mov	x17, xzr
	WORD $0x8b100870 // add	x16, x3, x16, lsl #2

BB0_5:
	WORD $0xb2400225 // orr	x5, x17, #0x1
	WORD $0xb27f0226 // orr	x6, x17, #0x2
	WORD $0xb2400627 // orr	x7, x17, #0x3
	WORD $0x9acc0e24 // sdiv	x4, x17, x12
	WORD $0x6f00e400 // movi	v0.2d, #0000000000000000
	WORD $0xaa0003f3 // mov	x19, x0
	WORD $0xaa1103f4 // mov	x20, x17
	WORD $0xaa0203f5 // mov	x21, x2
	WORD $0xaa0a03f6 // mov	x22, x10
	WORD $0x9acc0ca5 // sdiv	x5, x5, x12
	WORD $0x9acc0cc6 // sdiv	x6, x6, x12
	WORD $0x9acc0ce7 // sdiv	x7, x7, x12

BB0_6:
	WORD $0xd341fe97 // lsr	x23, x20, #1
	WORD $0x91000a98 // add	x24, x20, #2
	WORD $0xbc647aa3 // ldr	s3, [x21, x4, lsl #2]
	WORD $0xd341ff18 // lsr	x24, x24, #1
	WORD $0xbc657aa4 // ldr	s4, [x21, x5, lsl #2]
	WORD $0xbc667aa6 // ldr	s6, [x21, x6, lsl #2]
	WORD $0x38776837 // ldrb	w23, [x1, x23]
	WORD $0xf10006d6 // subs	x22, x22, #1
	WORD $0x8b090294 // add	x20, x20, x9
	WORD $0x38786838 // ldrb	w24, [x1, x24]
	WORD $0xd342fef9 // lsr	x25, x23, #2
	WORD $0x92400ef7 // and	x23, x23, #0xf
	WORD $0xd342ff1a // lsr	x26, x24, #2
	WORD $0x92400f18 // and	x24, x24, #0xf
	WORD $0xbc7779e1 // ldr	s1, [x15, x23, lsl #2]
	WORD $0x927e0f39 // and	x25, x25, #0x3c
	WORD $0xbc7879e5 // ldr	s5, [x15, x24, lsl #2]
	WORD $0xbc7969e2 // ldr	s2, [x15, x25]
	WORD $0x927e0f57 // and	x23, x26, #0x3c
	WORD $0x8b070ab9 // add	x25, x21, x7, lsl #2
	WORD $0x1e230821 // fmul	s1, s1, s3
	WORD $0x8b1701f7 // add	x23, x15, x23
	WORD $0x8b0d02b5 // add	x21, x21, x13
	WORD $0x1e240842 // fmul	s2, s2, s4
	WORD $0x0d4092e5 // ld1	{ v5.s }[1], [x23]
	WORD $0x0d409326 // ld1	{ v6.s }[1], [x25]
	WORD $0x2e26dca3 // fmul	v3.2s, v5.2s, v6.2s
	WORD $0x6e0c0441 // mov	v1.s[1], v2.s[0]
	WORD $0xbc404662 // ldr	s2, [x19], #4
	WORD $0x6e180461 // mov	v1.d[1], v3.d[0]
	WORD $0x4f821020 // fmla	v0.4s, v1.4s, v2.s[0]
	BNE  BB0_6
	WORD $0xd37ef624 // lsl	x4, x17, #2
	WORD $0x91001231 // add	x17, x17, #4
	WORD $0xeb09023f // cmp	x17, x9
	WORD $0x3ca46a00 // str	q0, [x16, x4]
	BLT  BB0_5
	WORD $0x9100056b // add	x11, x11, #1
	WORD $0x8b0e0000 // add	x0, x0, x14
	WORD $0xeb08017f // cmp	x11, x8
	BNE  BB0_4
	B    BB0_13

BB0_9:
	WORD $0xd37ef52a // lsl	x10, x9, #2
	WORD $0xaa1f03eb // mov	x11, xzr

BB0_10:
	WORD $0xaa1f03ec // mov	x12, xzr
	WORD $0xaa0303ed // mov	x13, x3

BB0_11:
	WORD $0x9100118c // add	x12, x12, #4
	WORD $0xa8817dbf // stp	xzr, xzr, [x13], #16
	WORD $0xeb09019f // cmp	x12, x9
	BLT  BB0_11
	WORD $0x9100056b // add	x11, x11, #1
	WORD $0x8b0a0063 // add	x3, x3, x10
	WORD $0xeb08017f // cmp	x11, x8
	BNE  BB0_10

BB0_13:
	WORD $0xa9434ff4 // ldp	x20, x19, [sp, #48]
	WORD $0xa94257f6 // ldp	x22, x21, [sp, #32]
	WORD $0xa9415ff8 // ldp	x24, x23, [sp, #16]
	WORD $0xa94067fa // ldp	x26, x25, [sp], #64 [transformed]

BB0_14:
	RET

TEXT ·fused_int4_matmul_neon(SB), $48-72
	MOVD input+0(FP), R0
	MOVD packed+8(FP), R1
	MOVD scales+16(FP), R2
	MOVD output+24(FP), R3
	MOVD pM+32(FP), R4
	MOVD pK+40(FP), R5
	MOVD pN+48(FP), R6
	MOVD pGroupSize+56(FP), R7
	MOVD pNumGroups+64(FP), R8
	MOVD R8, 0(RSP)
	WORD $0xf9400088           // ldr	x8, [x4]
	WORD $0xf100051f           // cmp	x8, #1
	BLT  BB1_14
	WORD $0xf94000c9           // ldr	x9, [x6]
	WORD $0xf100053f           // cmp	x9, #1
	BLT  BB1_14
	WORD $0xa9005ff8           // stp	x24, x23, [sp, #-48]! [transformed]
	WORD $0xf94000aa           // ldr	x10, [x5]
	WORD $0xa90157f6           // stp	x22, x21, [sp, #16]
	WORD $0xa9024ff4           // stp	x20, x19, [sp, #32]
	WORD $0xf100015f           // cmp	x10, #0
	BLE  BB1_9
	WORD $0xf9401beb           // ldr	x11, [sp, #48]
	WORD $0x2f0004e0           // mvni	v0.2s, #7
	WORD $0xd37ef54d           // lsl	x13, x10, #2
	WORD $0xaa1f03ee           // mov	x14, xzr
	WORD $0xf940016c           // ldr	x12, [x11]
	WORD $0xf94000eb           // ldr	x11, [x7]
	WORD $0xd37ef58c           // lsl	x12, x12, #2

BB1_4:
	WORD $0x9b097dcf // mul	x15, x14, x9
	WORD $0xaa1f03f0 // mov	x16, xzr
	WORD $0x8b0f086f // add	x15, x3, x15, lsl #2

BB1_5:
	WORD $0xb2400204 // orr	x4, x16, #0x1
	WORD $0xb27f0205 // orr	x5, x16, #0x2
	WORD $0xb2400606 // orr	x6, x16, #0x3
	WORD $0x9acb0e11 // sdiv	x17, x16, x11
	WORD $0x6f00e401 // movi	v1.2d, #0000000000000000
	WORD $0xaa0003e7 // mov	x7, x0
	WORD $0xaa1003f3 // mov	x19, x16
	WORD $0xaa0203f4 // mov	x20, x2
	WORD $0xaa0a03f5 // mov	x21, x10
	WORD $0x9acb0c84 // sdiv	x4, x4, x11
	WORD $0x9acb0ca5 // sdiv	x5, x5, x11
	WORD $0x9acb0cc6 // sdiv	x6, x6, x11

BB1_6:
	WORD $0x91000a76 // add	x22, x19, #2
	WORD $0xd341fe77 // lsr	x23, x19, #1
	WORD $0xbc717a85 // ldr	s5, [x20, x17, lsl #2]
	WORD $0xd341fed6 // lsr	x22, x22, #1
	WORD $0xbc647a86 // ldr	s6, [x20, x4, lsl #2]
	WORD $0xbc657a87 // ldr	s7, [x20, x5, lsl #2]
	WORD $0x38776837 // ldrb	w23, [x1, x23]
	WORD $0xf10006b5 // subs	x21, x21, #1
	WORD $0x8b090273 // add	x19, x19, x9
	WORD $0x38766836 // ldrb	w22, [x1, x22]
	WORD $0x12000ed8 // and	w24, w22, #0xf
	WORD $0x53047ed6 // lsr	w22, w22, #4
	WORD $0x1e270302 // fmov	s2, w24
	WORD $0x53047ef8 // lsr	w24, w23, #4
	WORD $0x4e0c1ec2 // mov	v2.s[1], w22
	WORD $0x12000ef6 // and	w22, w23, #0xf
	WORD $0x51002317 // sub	w23, w24, #8
	WORD $0x510022d6 // sub	w22, w22, #8
	WORD $0x1e2202e4 // scvtf	s4, w23
	WORD $0x1e2202c3 // scvtf	s3, w22
	WORD $0x8b060a96 // add	x22, x20, x6, lsl #2
	WORD $0x8b0c0294 // add	x20, x20, x12
	WORD $0x0ea08442 // add	v2.2s, v2.2s, v0.2s
	WORD $0x0d4092c7 // ld1	{ v7.s }[1], [x22]
	WORD $0x1e2408c4 // fmul	s4, s6, s4
	WORD $0x1e2308a3 // fmul	s3, s5, s3
	WORD $0x0e21d842 // scvtf	v2.2s, v2.2s
	WORD $0x6e0c0483 // mov	v3.s[1], v4.s[0]
	WORD $0x2e22dce2 // fmul	v2.2s, v7.2s, v2.2s
	WORD $0x6e180443 // mov	v3.d[1], v2.d[0]
	WORD $0xbc4044e2 // ldr	s2, [x7], #4
	WORD $0x4f821061 // fmla	v1.4s, v3.4s, v2.s[0]
	BNE  BB1_6
	WORD $0xd37ef611 // lsl	x17, x16, #2
	WORD $0x91001210 // add	x16, x16, #4
	WORD $0xeb09021f // cmp	x16, x9
	WORD $0x3cb169e1 // str	q1, [x15, x17]
	BLT  BB1_5
	WORD $0x910005ce // add	x14, x14, #1
	WORD $0x8b0d0000 // add	x0, x0, x13
	WORD $0xeb0801df // cmp	x14, x8
	BNE  BB1_4
	B    BB1_13

BB1_9:
	WORD $0xd37ef52a // lsl	x10, x9, #2
	WORD $0xaa1f03eb // mov	x11, xzr

BB1_10:
	WORD $0xaa1f03ec // mov	x12, xzr
	WORD $0xaa0303ed // mov	x13, x3

BB1_11:
	WORD $0x9100118c // add	x12, x12, #4
	WORD $0xa8817dbf // stp	xzr, xzr, [x13], #16
	WORD $0xeb09019f // cmp	x12, x9
	BLT  BB1_11
	WORD $0x9100056b // add	x11, x11, #1
	WORD $0x8b0a0063 // add	x3, x3, x10
	WORD $0xeb08017f // cmp	x11, x8
	BNE  BB1_10

BB1_13:
	WORD $0xa9424ff4 // ldp	x20, x19, [sp, #32]
	WORD $0xa94157f6 // ldp	x22, x21, [sp, #16]
	WORD $0xa9405ff8 // ldp	x24, x23, [sp], #48 [transformed]

BB1_14:
	RET
