//go:build !noasm && arm64
// Code generated by hwygen -c. DO NOT EDIT.

package matmul

import (
	"unsafe"

	"github.com/ajroetker/go-highway/hwy"
	"github.com/ajroetker/go-highway/hwy/contrib/matmul/asm"
)

func init() {
	if hwy.HasSME() {
		return
	}
	FusedNF4MatMulSiLU = fusedNF4MatMulSiLUAsmF32
	FusedNF4MatMulGELU = fusedNF4MatMulGELUAsmF32
	FusedNF4MatMulGELUApprox = fusedNF4MatMulGELUApproxAsmF32
	FusedNF4MatMulReLU = fusedNF4MatMulReLUAsmF32
	FusedInt4MatMulSiLU = fusedInt4MatMulSiLUAsmF32
	FusedInt4MatMulGELU = fusedInt4MatMulGELUAsmF32
	FusedInt4MatMulGELUApprox = fusedInt4MatMulGELUApproxAsmF32
	FusedInt4MatMulReLU = fusedInt4MatMulReLUAsmF32
	FusedNF4MatMulSwiGLU = fusedNF4MatMulSwiGLUAsmF32
	FusedInt4MatMulSwiGLU = fusedInt4MatMulSwiGLUAsmF32
}

func fusedNF4MatMulSiLUAsmF32(input []float32, packed []uint8, scales, output []float32, M, K, N, groupSize int) {
	if len(input) == 0 || len(packed) == 0 || len(scales) == 0 || len(output) == 0 {
		return
	}
	MVal := int64(M)
	KVal := int64(K)
	NVal := int64(N)
	groupSizeVal := int64(groupSize)
	asm.FusedNF4MatMulSiLU_F32(
		unsafe.Pointer(&input[0]),
		unsafe.Pointer(&packed[0]),
		unsafe.Pointer(&scales[0]),
		unsafe.Pointer(&output[0]),
		unsafe.Pointer(&MVal),
		unsafe.Pointer(&KVal),
		unsafe.Pointer(&NVal),
		unsafe.Pointer(&groupSizeVal),
	)
}

func fusedNF4MatMulGELUAsmF32(input []float32, packed []uint8, scales, output []float32, M, K, N, groupSize int) {
	if len(input) == 0 || len(packed) == 0 || len(scales) == 0 || len(output) == 0 {
		return
	}
	MVal := int64(M)
	KVal := int64(K)
	NVal := int64(N)
	groupSizeVal := int64(groupSize)
	asm.FusedNF4MatMulGELU_F32(
		unsafe.Pointer(&input[0]),
		unsafe.Pointer(&packed[0]),
		unsafe.Pointer(&scales[0]),
		unsafe.Pointer(&output[0]),
		unsafe.Pointer(&MVal),
		unsafe.Pointer(&KVal),
		unsafe.Pointer(&NVal),
		unsafe.Pointer(&groupSizeVal),
	)
}

func fusedNF4MatMulGELUApproxAsmF32(input []float32, packed []uint8, scales, output []float32, M, K, N, groupSize int) {
	if len(input) == 0 || len(packed) == 0 || len(scales) == 0 || len(output) == 0 {
		return
	}
	MVal := int64(M)
	KVal := int64(K)
	NVal := int64(N)
	groupSizeVal := int64(groupSize)
	asm.FusedNF4MatMulGELUApprox_F32(
		unsafe.Pointer(&input[0]),
		unsafe.Pointer(&packed[0]),
		unsafe.Pointer(&scales[0]),
		unsafe.Pointer(&output[0]),
		unsafe.Pointer(&MVal),
		unsafe.Pointer(&KVal),
		unsafe.Pointer(&NVal),
		unsafe.Pointer(&groupSizeVal),
	)
}

func fusedNF4MatMulReLUAsmF32(input []float32, packed []uint8, scales, output []float32, M, K, N, groupSize int) {
	if len(input) == 0 || len(packed) == 0 || len(scales) == 0 || len(output) == 0 {
		return
	}
	MVal := int64(M)
	KVal := int64(K)
	NVal := int64(N)
	groupSizeVal := int64(groupSize)
	asm.FusedNF4MatMulReLU_F32(
		unsafe.Pointer(&input[0]),
		unsafe.Pointer(&packed[0]),
		unsafe.Pointer(&scales[0]),
		unsafe.Pointer(&output[0]),
		unsafe.Pointer(&MVal),
		unsafe.Pointer(&KVal),
		unsafe.Pointer(&NVal),
		unsafe.Pointer(&groupSizeVal),
	)
}

func fusedInt4MatMulSiLUAsmF32(input []float32, packed []uint8, scales, output []float32, M, K, N, groupSize int) {
	if len(input) == 0 || len(packed) == 0 || len(scales) == 0 || len(output) == 0 {
		return
	}
	MVal := int64(M)
	KVal := int64(K)
	NVal := int64(N)
	groupSizeVal := int64(groupSize)
	asm.FusedInt4MatMulSiLU_F32(
		unsafe.Pointer(&input[0]),
		unsafe.Pointer(&packed[0]),
		unsafe.Pointer(&scales[0]),
		unsafe.Pointer(&output[0]),
		unsafe.Pointer(&MVal),
		unsafe.Pointer(&KVal),
		unsafe.Pointer(&NVal),
		unsafe.Pointer(&groupSizeVal),
	)
}

func fusedInt4MatMulGELUAsmF32(input []float32, packed []uint8, scales, output []float32, M, K, N, groupSize int) {
	if len(input) == 0 || len(packed) == 0 || len(scales) == 0 || len(output) == 0 {
		return
	}
	MVal := int64(M)
	KVal := int64(K)
	NVal := int64(N)
	groupSizeVal := int64(groupSize)
	asm.FusedInt4MatMulGELU_F32(
		unsafe.Pointer(&input[0]),
		unsafe.Pointer(&packed[0]),
		unsafe.Pointer(&scales[0]),
		unsafe.Pointer(&output[0]),
		unsafe.Pointer(&MVal),
		unsafe.Pointer(&KVal),
		unsafe.Pointer(&NVal),
		unsafe.Pointer(&groupSizeVal),
	)
}

func fusedInt4MatMulGELUApproxAsmF32(input []float32, packed []uint8, scales, output []float32, M, K, N, groupSize int) {
	if len(input) == 0 || len(packed) == 0 || len(scales) == 0 || len(output) == 0 {
		return
	}
	MVal := int64(M)
	KVal := int64(K)
	NVal := int64(N)
	groupSizeVal := int64(groupSize)
	asm.FusedInt4MatMulGELUApprox_F32(
		unsafe.Pointer(&input[0]),
		unsafe.Pointer(&packed[0]),
		unsafe.Pointer(&scales[0]),
		unsafe.Pointer(&output[0]),
		unsafe.Pointer(&MVal),
		unsafe.Pointer(&KVal),
		unsafe.Pointer(&NVal),
		unsafe.Pointer(&groupSizeVal),
	)
}

func fusedInt4MatMulReLUAsmF32(input []float32, packed []uint8, scales, output []float32, M, K, N, groupSize int) {
	if len(input) == 0 || len(packed) == 0 || len(scales) == 0 || len(output) == 0 {
		return
	}
	MVal := int64(M)
	KVal := int64(K)
	NVal := int64(N)
	groupSizeVal := int64(groupSize)
	asm.FusedInt4MatMulReLU_F32(
		unsafe.Pointer(&input[0]),
		unsafe.Pointer(&packed[0]),
		unsafe.Pointer(&scales[0]),
		unsafe.Pointer(&output[0]),
		unsafe.Pointer(&MVal),
		unsafe.Pointer(&KVal),
		unsafe.Pointer(&NVal),
		unsafe.Pointer(&groupSizeVal),
	)
}

func fusedNF4MatMulSwiGLUAsmF32(input []float32, gatePacked []uint8, gateScales []float32, upPacked []uint8, upScales, output []float32, M, K, N, groupSize int) {
	if len(input) == 0 || len(gatePacked) == 0 || len(gateScales) == 0 || len(upPacked) == 0 || len(upScales) == 0 || len(output) == 0 {
		return
	}
	MVal := int64(M)
	KVal := int64(K)
	NVal := int64(N)
	groupSizeVal := int64(groupSize)
	asm.FusedNF4MatMulSwiGLU_F32(
		unsafe.Pointer(&input[0]),
		unsafe.Pointer(&gatePacked[0]),
		unsafe.Pointer(&gateScales[0]),
		unsafe.Pointer(&upPacked[0]),
		unsafe.Pointer(&upScales[0]),
		unsafe.Pointer(&output[0]),
		unsafe.Pointer(&MVal),
		unsafe.Pointer(&KVal),
		unsafe.Pointer(&NVal),
		unsafe.Pointer(&groupSizeVal),
	)
}

func fusedInt4MatMulSwiGLUAsmF32(input []float32, gatePacked []uint8, gateScales []float32, upPacked []uint8, upScales, output []float32, M, K, N, groupSize int) {
	if len(input) == 0 || len(gatePacked) == 0 || len(gateScales) == 0 || len(upPacked) == 0 || len(upScales) == 0 || len(output) == 0 {
		return
	}
	MVal := int64(M)
	KVal := int64(K)
	NVal := int64(N)
	groupSizeVal := int64(groupSize)
	asm.FusedInt4MatMulSwiGLU_F32(
		unsafe.Pointer(&input[0]),
		unsafe.Pointer(&gatePacked[0]),
		unsafe.Pointer(&gateScales[0]),
		unsafe.Pointer(&upPacked[0]),
		unsafe.Pointer(&upScales[0]),
		unsafe.Pointer(&output[0]),
		unsafe.Pointer(&MVal),
		unsafe.Pointer(&KVal),
		unsafe.Pointer(&NVal),
		unsafe.Pointer(&groupSizeVal),
	)
}

