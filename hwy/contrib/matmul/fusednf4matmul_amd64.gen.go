// Code generated by github.com/ajroetker/go-highway/cmd/hwygen. DO NOT EDIT.

//go:build amd64 && goexperiment.simd

package matmul

import (
	"simd/archsimd"

	"github.com/ajroetker/go-highway/hwy"
)

var FusedNF4MatMul func(input []float32, packed []uint8, scales []float32, output []float32, M int, K int, N int, groupSize int)
var FusedInt4MatMul func(input []float32, packed []uint8, scales []float32, output []float32, M int, K int, N int, groupSize int)

func init() {
	if hwy.NoSimdEnv() {
		initFusednf4matmulFallback()
		return
	}
	if archsimd.X86.AVX512() {
		initFusednf4matmulAVX512()
		return
	}
	if archsimd.X86.AVX2() {
		initFusednf4matmulAVX2()
		return
	}
	initFusednf4matmulFallback()
}

func initFusednf4matmulAVX2() {
	FusedNF4MatMul = BaseFusedNF4MatMul_avx2
	FusedInt4MatMul = BaseFusedInt4MatMul_avx2
}

func initFusednf4matmulAVX512() {
	FusedNF4MatMul = BaseFusedNF4MatMul_avx512
	FusedInt4MatMul = BaseFusedInt4MatMul_avx512
}

func initFusednf4matmulFallback() {
	FusedNF4MatMul = BaseFusedNF4MatMul_fallback
	FusedInt4MatMul = BaseFusedInt4MatMul_fallback
}
